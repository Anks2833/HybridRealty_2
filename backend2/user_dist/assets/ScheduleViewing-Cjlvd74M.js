import{c as v}from"./createLucideIcon-_nPPgzl3.js";import{r as n,j as e,y as h,b as I,B as L}from"./index-79N5OtCp.js";import{A as V}from"./index-YOt_O6vL.js";import{m as d}from"./proxy-D0PgdC8m.js";import{X as H}from"./x-CnZYhJ-W.js";import{M}from"./map-pin-DneFzhFJ.js";import{C as u}from"./calendar-C9n2_Z2a.js";import{C as f}from"./clock-vqhgGNuZ.js";import{L as F}from"./loader--S0-QfwE.js";import{C as O}from"./circle-check-big-BPvEC-Jo.js";import{U as R}from"./users-CvXNrr8d.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=v("BookMarked",[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=v("Compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=v("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),se=({propertyId:A,propertyTitle:c,propertyLocation:j,propertyImage:N,onClose:g})=>{const[a,p]=n.useState({date:"",time:"",notes:""}),[l,w]=n.useState(!1),[i,b]=n.useState(1),[k,B]=n.useState(!1),$=n.useMemo(()=>{const t=[];for(let s=9;s<=18;s++)t.push(`${s.toString().padStart(2,"0")}:00`),t.push(`${s.toString().padStart(2,"0")}:30`);return t},[]),x=n.useMemo(()=>{const t=new Date,s=new Date;return s.setDate(t.getDate()+30),t.setHours(0,0,0,0),{min:t.toISOString().split("T")[0],max:s.toISOString().split("T")[0]}},[]),z=t=>{const s=new Date(t);return s.getDay()===0||s.getDay()===6},S=t=>{const[s,r]=t.split(":").map(Number),o=new Date,m=new Date(a.date);return m.setHours(s,r),m<o},P=t=>{const s=t.target.value;if(z(s)){h.error("Viewings are not available on weekends");return}p(r=>({...r,date:s,time:""}))},T=t=>{const s=t.target.value;if(a.date===x.min&&S(s)){h.error("Please select a future time slot");return}p(r=>({...r,time:s}))},q=async t=>{var s,r;t.preventDefault();try{const o=localStorage.getItem("token");if(!o){h.error("Please login to schedule a viewing");return}w(!0),(await I.post(`${L}/api/appointments/schedule`,{propertyId:A,...a},{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}})).data.success&&(B(!0),setTimeout(()=>{g()},3e3))}catch(o){console.error("Scheduling error:",o);const m=((r=(s=o.response)==null?void 0:s.data)==null?void 0:r.message)||"Error scheduling viewing";h.error(m)}finally{w(!1)}},C=t=>{if(!t)return"";const s={weekday:"long",year:"numeric",month:"long",day:"numeric"};return new Date(t).toLocaleDateString("en-US",s)},D=a.date&&a.time;return e.jsx(V,{children:e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4 backdrop-blur-sm",children:e.jsxs(d.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},className:"bg-white rounded-xl p-6 sm:p-8 w-full max-w-lg shadow-2xl relative overflow-hidden",children:[e.jsx("button",{onClick:g,className:"absolute top-5 right-5 text-gray-400 hover:text-gray-600 bg-white rounded-full p-1 hover:bg-gray-100 transition-colors z-10","aria-label":"Close dialog",children:e.jsx(H,{size:20})}),k?e.jsxs(d.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-6",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(O,{className:"w-8 h-8 text-[var(--theme-color-3)]"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Viewing Scheduled!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"We've sent you a confirmation email with all the details."}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 max-w-xs mx-auto mb-6",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(u,{className:"w-4 h-4 text-[var(--theme-color-1)] mr-2"}),e.jsx("span",{className:"text-gray-700 text-sm",children:C(a.date)})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(f,{className:"w-4 h-4 text-[var(--theme-color-1)] mr-2"}),e.jsx("span",{className:"text-gray-700 text-sm",children:a.time})]}),c&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"w-4 h-4 text-[var(--theme-color-1)] mr-2"}),e.jsx("span",{className:"text-gray-700 text-sm",children:c})]})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"One of our agents will contact you to confirm the details."}),e.jsx("button",{onClick:g,className:"bg-[var(--theme-color-1)] text-white py-2 px-6 rounded-lg hover:bg-[var(--theme-hover-color-1)] transition-colors",children:"Close"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center mb-4 pb-3 border-b border-gray-100",children:[N&&e.jsx("div",{className:"mr-4 flex-shrink-0",children:e.jsx("img",{src:N,alt:c,className:"w-16 h-16 object-cover rounded-lg"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 truncate",children:"Schedule a Viewing"}),c&&e.jsx("p",{className:"text-gray-700 font-medium truncate",children:c}),j&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(M,{className:"w-3 h-3 mr-1"}),e.jsx("span",{className:"truncate",children:j})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:`flex flex-col items-center ${i>=1?"text-[var(--theme-color-1)]":"text-gray-400"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 mb-1 ${i>=1?"border-[var(--theme-color-1)] bg-blue-50":"border-gray-300"}`,children:e.jsx(u,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-xs",children:"Date & Time"})]}),e.jsx("div",{className:"flex-1 h-0.5 mx-4 bg-gray-200",children:e.jsx("div",{className:"h-full bg-[var(--theme-color-1)] transition-all duration-300",style:{width:i>=2?"100%":"0%"}})}),e.jsxs("div",{className:`flex flex-col items-center ${i>=2?"text-[var(--theme-color-1)]":"text-gray-400"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 mb-1 ${i>=2?"border-[var(--theme-color-1)] bg-blue-50":"border-gray-300"}`,children:e.jsx(y,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-xs",children:"Details"})]})]})}),e.jsxs("form",{onSubmit:q,children:[i===1&&e.jsxs(d.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Date"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",value:a.date,onChange:P,min:x.min,max:x.max,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--theme-hover-color-1)] focus:border-[var(--theme-hover-color-1)] shadow-sm",required:!0,disabled:l}),e.jsx(u,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1.5 flex items-center",children:[e.jsx(y,{className:"w-3 h-3 mr-1 inline flex-shrink-0"}),"Available Monday to Friday, up to 30 days in advance"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Time Slot"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:a.time,onChange:T,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--theme-hover-color-1)] focus:border-[var(--theme-hover-color-1)] shadow-sm appearance-none cursor-pointer",required:!0,disabled:!a.date||l,children:[e.jsx("option",{value:"",children:"Choose a time slot"}),$.map(t=>e.jsx("option",{value:t,disabled:a.date===x.min&&S(t),children:t},t))]}),e.jsx(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1.5 flex items-center",children:[e.jsx(y,{className:"w-3 h-3 mr-1 inline flex-shrink-0"}),"Available from 9:00 AM to 6:00 PM"]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"button",onClick:()=>D&&b(2),disabled:!D||l,className:`w-full bg-[var(--theme-color-1)] text-white py-3 rounded-lg hover:bg-[var(--theme-hover-color-1)] \r
                          transition-colors flex items-center justify-center gap-2 disabled:bg-blue-300`,children:"Continue"})})]}),i===2&&e.jsxs(d.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-5",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Selected Time"}),e.jsx("button",{type:"button",onClick:()=>b(1),className:"text-xs text-[var(--theme-color-1)] hover:text-blue-800",children:"Change"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(u,{className:"w-4 h-4 text-[var(--theme-color-1)] mr-2"}),e.jsx("span",{className:"text-gray-700",children:C(a.date)})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(f,{className:"w-4 h-4 text-[var(--theme-color-1)] mr-2"}),e.jsx("span",{className:"text-gray-700",children:a.time})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex justify-between text-sm font-medium text-gray-700 mb-1",children:[e.jsx("span",{children:"Additional Notes"}),e.jsx("span",{className:"text-gray-400 text-xs",children:"(Optional)"})]}),e.jsx("textarea",{value:a.notes,onChange:t=>p(s=>({...s,notes:t.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--theme-hover-color-1)] focus:border-[var(--theme-hover-color-1)] shadow-sm",rows:4,placeholder:"Any specific requirements or questions about the property...",disabled:l})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 pt-3",children:[e.jsx("button",{type:"button",onClick:()=>b(1),disabled:l,className:`lg:w-1/2 order-2 lg:order-1 bg-gray-100 text-gray-700 py-3 rounded-lg hover:bg-gray-200 \r
                          transition-colors flex items-center justify-center gap-2 disabled:bg-gray-100 disabled:text-gray-400`,children:"Back"}),e.jsx("button",{type:"submit",disabled:l,className:`lg:w-1/2 order-1 lg:order-2 bg-[var(--theme-color-1)] text-white py-3 rounded-lg hover:bg-[var(--theme-hover-color-1)] \r
                          transition-colors flex items-center justify-center gap-2 disabled:bg-blue-400`,children:l?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4 animate-spin"}),"Scheduling..."]}):"Schedule Viewing"})]})]})]})]}),!k&&e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(R,{className:"w-4 h-4 text-[var(--theme-color-1)] mr-2"}),e.jsx("span",{children:"A qualified agent will guide you through the viewing"})]})})]})})})};export{ee as B,te as C,se as S};
